# 代码规范
贡献者：何文轩
## 引言
> - 代码规范是软件开发中制定的一系列规则和标准，旨在统一代码风格和结构。遵守代码规范对于团队开发具有以下重要性：
> - 提高代码质量：统一的代码风格和规范有助于减少错误和漏洞，提升软件的安全性和稳定性。 
> - 降低维护成本：规范化的代码更易于修改和扩展，减少维护工作量，降低长期维护成本。 
> - 确保可读性和一致性：统一的编码风格使代码结构清晰，易于阅读和理解，便于快速定位问题和分享知识。 
> - 总之，遵循代码规范对于提升代码质量、促进团队协作、降低维护成本以及确保代码可读性和一致性至关重要。
## 引用规范
所有“include”和“extern”在.h文件中调用，使.c文件更简洁美观
## 格式规范
1. 所有Tab全部使用4个空格替代，尽量不要使用Tab进行缩进，请敲击四下空格键,不然有其他人的Tab缩进与你的设置不同，在他那里你的项目格式全是错误的
2. 除了函数，像if，while等函数把左括号写到条件括号右边，例如：   
``` bash
if(条件){
    函数体
}else if(条件){
    函数体
}else {
    函数体
}

```
3. 在运算符两边都要加上空格，每一个逗号后面也要加上空格
4. 如果一个函数中的参数过多，请进行分行，例如：
``` bash
void PID_init(PID_struct_t *PID,
              float kp,
              float ki,
              float kd,
              float kf,
              float i_max,
              float out_max)
{
    函数体
}
```
## 命名规范
所有命名必须让人看一眼就知道是干嘛的，不准使用拼音，请使用英文,尤其不准使用aaa这种莫名其妙的东西，除了在循环中不准使用单字母，for循环中，最好以i，j，k的顺序分别做内外层循环。
### 文件
下划线命名法（Snake_Case）：?函数名全部使用小写字母，单词之间以下划线连接。例如：chassis_task,gimbal_task
### 函数
命名时注意动词的使用
比如我们需要从数据库中获取用户信息，函数的名称可以是userInfo，user或者fetchUser，但推荐使用含有动词的命名 getUser。   
小驼峰式（lowerCamelCase）：函数名以小写字母开头，后续单词的首字母大写。这里我们要求把函数返回值类型写在函数名开头，例如底盘解算函数就写成vChassisCalculate，表示函数返回值为void类型。具体对应关系为：   
| 返回值类型 | 字母   | 
| :----:    | :----: |
| void      | v      |
| int       | i      |
| float     | f      |
| double    | d      |
| char      | c      |
| struct    | s      |
| enum      | e      |
| bool      | b      |
### 全局变量
变量命名的要求和函数命名的要求类似，要求尽可能的清晰明了
### 临时变量
临时变量以要加一个前缀，例如cnt_Delay，就表示用计数延时代替Delay的计数临时变量，前缀和作用对应关系为：
| 临时变量作用类型 | 字母   | 
| :----:          | :----:  |
| 计数            | cnt    |
| 状态            | state  |
| 临时            | tmp    |
| 其他            | 英文简写|
### 常数变量
常量值所有都大写，常量命名都使用全大写的名称，并用下划线分割所有单词例如：
``` bash
#define DAYS_IN_A_YEAR = 365;
```

## 函数规范
1. 函数深度嵌套
有些程序需要使用到无数次的嵌套循环，看着看着就晕了，这时可以将所有循环提取到单独的函数中。
假设有一个包含两层嵌套的数组，想要拿到最后一个数组的值？一般情况下开发者都会使用嵌套循环，但不是最佳的办法。可以尝试使用函数的反复调用来完成操作执行相同操作的，这样一来代码重复性更小，更易于阅读、重用性高。
2. 避免创建大函数
当一个函数或一个类需要实现的功能太多时，建议将其分成多个小的函数。也易于后续修改，但是也不能分太细，分太细反而会让人不好找。

## 注释规范
注释的作用是让人更容易理解代码，所以注释的内容应该是对代码的解释，而不是对代码的重复
例如：
``` bash
void swap(int *a, int *b){ // 交换两个数
    int temp = *a;      // 存下 a 的值
    *a = *b;            // 将 b 的值赋给 a
    *b = temp;          // 将 a 的值赋给 b
}
```
这种代码注释就是纯多余
### 函数注释
``` bash
 /**
 * @file 函数存放文件名
 * @brief 函数作用
 * @param 传参
 * @return 返回值含义
 * @note 注意事项（比如哪些东西是要修改的）
 * @par 示例代码（与note配合使用）
 * @author 作者
 * @date 完成日期
 */
```
### 计算注释
+ 对全局变量、常量或难以理解的变量，添加注释说明其用途和取值范围。
+ 在条件判断、循环等控制结构前，添加注释说明其作用和判断条件，特别是复杂的嵌套结构。
+ 对于异常处理、错误捕获、特殊输入等情况，添加注释说明处理方式和原因。
+ 对于复杂或不直观的代码逻辑、算法，添加注释以解释其工作原理，帮助他人理解。
## 项目架构
项目总文件下，Cubemx生成的格式保持不变，自己创建不同的文件夹存放不同的文件，文件夹推荐分类为：
| 文件夹 | 作用 | 
| :----: | :----: |
| Task文件夹 | 为每一个Task单独新建一个文件夹存放到这个里面 |
| 通信文件夹 | 存放各类似于串口、can、spi、iic等通信的函数 |
| 控制文件夹 | 存放不同Task的计算文件 |
| 电机文件夹 | 存放不同电机的控制文件 |
| 其他库文件 | 如果有调用其他库文件，直接单独存放到一个文件夹里就行 |

老代码里都是把每一个Task的任务写在了对应的同一个文件下，但我认为那样子并不方便